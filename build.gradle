/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn how to create Gradle builds at https://guides.gradle.org/creating-new-gradle-builds/
 */
plugins {
    // https://github.com/palantir/gradle-docker
    // https://plugins.gradle.org/plugin/com.palantir.docker-run
    id 'com.palantir.docker' version '0.21.0'
    id 'com.palantir.docker-compose' version '0.21.0'
    id 'com.palantir.docker-run' version '0.21.0'
}
apply plugin: "com.palantir.docker"
apply plugin: "com.palantir.docker-compose"
apply plugin: "com.palantir.docker-run"

import com.palantir.gradle.docker.tasks.DockerRemoveContainer


// retrieve ENV variables
def DOCKER_USERNAME = System.env.DOCKER_USERNAME
def BEATS_VERSION = System.env.BEATS_VERSION



task cleanup(type: DockerRemoveContainer) {

    // docker image rmi ${DOCKER_USERNAME}/auditbeat:${BEATS_VERSION} -f  || true
    // name "${DOCKER_USERNAME}/auditbeat:${BEATS_VERSION}"
    targetContainerId { 'apolloclark/auditbeat:latest' }

    // docker image rmi $DOCKER_USERNAME/auditbeat:$(date -u '+%Y%m%d') -f  || true
    //  docker image rmi $DOCKER_USERNAME/auditbeat:latest -f  || true
}